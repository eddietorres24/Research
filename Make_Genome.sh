#!/bin/bash
#SBATCH --job-name=Make_Genome_ET
#SBATCH --partition=batch
#SBATCH --mail-type=ALL
#SBATCH --mail-user=evt82290@uga.edu
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=24
#SBATCH --mem=50gb
#SBATCH --time=4:00:00
#SBATCH --output=logs/genome.%j.out
#SBATCH --error=logs/genome.%j.err

cd $SLURM_SUBMIT_DIR

module load Biopython

from Bio.Seq import Seq
from Bio import SeqIO

# Define the name of the FASTA file and the sequence ID
fasta_file="/fasta_genome_files/GCA_000182925.2_NC12_genomic_wTetO_at_his3_CLEAN.fasta"
seq_id= "ACATTCACATGACCTGCAAACTGTCTAGGAAAAGACATCAGTTTACGTGATCTCATCAACCATCAGTTTGCGTAATCACATCAACCATCAAAGCGACAGTGATGACGATGCAGTGAAGAAGGGTGGGTGTGCAGCGCAGGAAATCCATTTTGATGGGCTATCTAGATATTATAGCAGCACATTCATATGAATATTATGGTACCGCGACTCCAATCCCTAAAACCCTCGACAATGTCCACAAGGGAATTTAGAGAGCGCCGCAGTCGACAATGGTGGGCTTCTTGGAGTAACGAATAGCACCGCTGCTGGAGCCAGTAGCCTCAAGGGCCTTGACGACCTTCATGGACTCATCGTCAGCGACCTCGCCGAAGACGACGTGGCGGCCATCGAGCCAGCTGGTGGGGACAGTGGTGACGAAGAACTGGGAGCCGTTGGTGTTGGGGCCGGCGTTGGCCATGGAGAGAAGACCAGGGCGGACGTGCTTCTTGGCGAAGTTCTCATCGGCGAACTTCTCGCCGTAGATGGACTTGCCACCAGTGCCCTGTTCAGAGAGGTTAGGTCTTTATTTTCCCATGTTCGATAGCTTGTTGGGCGGACATGGACTTACGTTACCACGGGTGAAGTCACCACCCTGGAGCATGAACTCGGGGATAATGCGGTGGAAAGAAGAGCCCTTGTAGCCGAAGCCGTTCTGGCCAGTGCAGAGCTCCTTGAAGTTGCGGGCGGTCTTGGGGACAACGTCGTCGTAGAGGGTGAAGTTAATGCGGCCAGACTGAGCTGCATTGGGAGTTAGACATCCGATGGGCATGACATGACAGTTGACGGGCGGGGCCGGGGGGAGGGCGGTGAGGCTGAGTGGTGCGGGCGTTATGATTCAGGGGCACCGGTATGGAGGGGTAGTTCAGGAGCTTGCGGGCTGCGGCAACACCGGGACGACGCCGTGCTCATTGCGAACAACGACAGACGTCCAGGTGAAGTCCCAGCGACCGTCGCAAGTTTCCTGAGCCTGATTGATGAAGACAAAGCAGATGAGGAGAGTAGACTTACCCTTGATTTCGCTGGTGGGCTTGTTGTTGGGGCCGAGGACGGGACCCTCCCACTCGAGATCGAAGAAACTAAAGCATGCAGGTCAGTCGGTGTCCCTGAAGCTACGGGTAGGTAGGCGCAGCTCCCATGTTTGCGCGGACCTGGAGAAGCGGCTGGACTTACACCTTGGACATGATGCTGGATGTTTGCGAAAAAGCTCTGGCGCAGGAGAAAGTTGCAGTGGGCTTGAGAGATGACGAGAAAGTCGAGGAGACGAGAGAACCTGTTGTCTTAAGGACAGAGAAATGGCGGGGTCCAAACATTTTCACTAAAATGGAAAGGAGGGGTCAGCCAATCCGAGAAGTGGGGGGCGGAGAAGGTACGTAGCTGCTCGCCACGTGATTGATTGTTGCGACTCGAGCTGTCGGCCTGTCGCCACGCCGCCTGTTTCGGTCTCGTTTGCCAGTGCGGCGGGAGACGACGAAACAGCAGGTCAGCTTGACAACGTGGAGTGGTATGAGCCTCTGCAAGTGTCATCTTTGGCGCATGTGGGCTTCGGATTGGTTCGTTGGCTCAGGAACACCAGTACGAACAAGTAAACAGCTGCCATCTGGTGTTGGCGCTTCCCCCCCGAGTCTCCAAGGTCCCGTCGGCCCTGACGCTGACGGCAATGACAATCAAAACTGCCACCACCCGTGTGTGTATAGTTGGCAGCTAAAGCGCTGGCAAGAGCTATCCAAAGACATCCGGGCCAAAGGACCGTAGACCCATGGCTCCATCATATGGCTTGTTGGGTCTTCATAGCGTTGCGATTGCCTCTTTCATTTGGAGTCCCCCTCTGTCAATGCAGCCATTGACGACATTGCGGAGCCATGGACGATACCCCAAGCCGAACAAGAGGGATGGACGGCATTAACGACCTTGATGGCCATGTCTGGGGTAGGGACCAAAAGGCGGTGGTGGTATTGTCAAACTAACAAACCTCACCCCTCATCTCGAGCGTGGATGGAAAAAAGGACATTCGAATT"
new_sequence= "ACACCCGACCCGACTCCGTTCTCCCTCTCGTCTCAGGTCTTTGTTGTGCATCCATCGCCGTGTAGCAGATTTCCATCGTTCGTTTGTTCGGACTTTACCTTGTACTTTTAGCTTCATTATCATCCTACAATCATCCAGGATTTCATCTTCCACAACCGGTACGTTATCATTTTTACTTTTGTTGCCATGTTCTTCTTGAGCCTTTTCTGTCTAGAGGAGCTCTCCCTGCCGGCTGGGAGCTTGCCCAAAGCTCCAAGCTCTATCTGTGGCAGAGCTCTGAGAGCTTCCATTCCCGGGATTTCTTGGCATCAGATTCAATTCGAATGTCCTTTTTTCCATCCACGCTCGAGATGAGGGGTGAGGTTTGTTAGTTTGACAATACCACCACCGCCTTTTGGTCCCTACCCCAGACATGGCCATCAAGGTCGTTAATGCCGTCCATCCCTCTTGTTCGGCTTGGGGTATCGTCCATGGCTCCGCAATGTCGTCAATGGCTGCATCCATTGCCAAGTCTGGTCGTGAATGGCTGCTGGTGGAGATAGTATCCGAAACACACCGGGTTAAGTAAATGCTAAATAGGGATTCGGATGAATTCATGGGGTTGAACTCCACTTCTTCAACCTTGTTCCCGAGTCCATCCTAAAGTCAACCTGAATCTCCTTTGGTCGAGATAAAGCGATGTGCAATGAATGGAATTTGAGACATGATATAGAAAAAACTGAAGAGATGAAGCTTGAAAAAGTGAGAAATCATGAAATTTGCCGGAAGTAGGGACGTCCAACAATTGTGCGGGCAATGAAACTGGGAGCGTCCCTGGCCAGAAACATTCGGGAGCCCGTATGCTATCGCCGTGGGCCGCGAGAATACCTTAAGCTCGAGTGGAGGGATCTTGGTAAGGTTGAGACGTATTGAAGATGGGGCAGACGTGTGCCGATCCGTTTGTCCTGCGTCGCTTCAGTGTGATCGGATTGCGCACAGATCATGTCCGAGAAGCTTTGACTTAAGGTTTAGTAGTATGATCTGAATGGAAAGCGATGAGCAGACGAGAAACCCGGAGGAGTGTAAAAAGATCATGAAGCGGCAGTGAGGCTCAGATATCGGTATACTGGCAAATGGCAGTTCAAATACAGGGGCACGTAGACAACAATGAGCACACTGAAAATTTAGAAGAACTCCAGAAACCTTCAACTCATGCTGGATGACGTATCGTGCGTTGTCATCCCGAGGGCCAAATCCAAAACTGAGCCGGTGGTGAATGCAAGAGCGGATGAGAACAATAAGGGCAACCTTCAGTGGAACGGCTGGAAGTGTGAGAAATCCGCGAAAATCAAACGGAAAGAGCTCAAATATATCGGTCCCGATGAGACATCTGCTGCACTTGAATAGCTCCCGTCTATGTACATAGCCATTATCTTGGACAAGAAACAGTCGCACCGCATCTTCGAGTGCAACTCCGTCCTGCCTTCCGGCTAACGGTCCCCACAGACGAGGAAGATCAGGGGTGCAGTTTCCGTTCCGCTGGTCATTGTTAGATCTGCGACTTCCATTGCATGGATTTGGCCGAGCCTTTGTGCCAAGACCAGAGGCAGACAAGATAAGATCTGTGGACGGGCCGTTTTAGCGTATCCGGTAAACATTTTCTGTAGAAACCTTGGCAATCGGCGGAAACCGTTAGCGACTGCAATGCCACATGGATTCAAGAGTGTTCTCGCGAAAAGGTTCCTTTTCTCAGTCAATGCGATGATTTCGATTTTCTTTGCCTTCCTTCGCAAATCCTCCTTTGTTCCTACCCTCTCGAATGATTTCGTCGTTACCGAGTTGTGTCTGTCCCCTCGACGTTTAGGATCCATCTTTATGAGTAGGGCACCCCTGTCAGTGAGTGGAAATACGGCCAATGAGATAGAATCAACCTGACAGAAAGGGAAGGTGTGACAGGGTTCTTGCCGAAACCAAAACGCCGAGCCTCCATGGTGCCTTCCCCACTGTAGACGACGTGCCATGGGTGACATCAATTGACCCTGAAAGGTCATGTTTGTCGGACCGGAGGACGATTATCGGTGATCGAAGTAACGGAGTAGACACAGTTTCTGGGGGATAATGGGATCGTTAATGCATACCTGTTTAGAGGTACTCGCCGTATTTCCCTCCAAGTTGACATGATATCCGGCTGTCAAGTCGTGCGCAATCGGTACAAACAGAAGTTGCGACTCTCCAGAGGCCATCGCACCGGAACTTGGCGTTGTATCAAATACCCTTCATCGTACTTTCCAAATGCCAGAGTGAAATGGTGATGTTCCCACTGCATGATTGTTACTTCCTTACTCGCTATCACCTTCTCCTACTGTTTCCCCCGCTCGCAGCGAGGGGTTCCTGCTCGCCGCTTTGCTTCGGTAATGCTGCCAGAATCGCCGAGGCAGCCGAATGAGCCGTCATGCACATGTGCTTGGCAGATATTTGACAGAAAGAGGATCGTGAGCAGCCTCGGCGAGAAGAGGGAAAGCCCACATACGTGTACGGTGCAGCTGACACCTAAATGCATGCGTGGTAAATCGAGCTCGTCCTTGGCAGTTGAAACGGACTGCACCGGGACATGTTCCTCCAGTCCAACTGGGACCATTGCCATTGCCCAGAATCCACGCGCATGGGTTGGCTCAGTTATGTGCCCGCTCTCCCTCTTCTTCCAAATATCCTTCGATATCGTCAGGGGAATCATTTGCTTCCGTCACCTCCTTGCTCCTGCCTTTGGCCCCCATCGTGGACGAAAGTGTCGTAGCCTATTCCCATCGTCCATTTTCGCAACTGCCCCTTATACTGTTGATGGCAACAACGCGTCCCGTCCTCGCGCCTTCCACCTGCCACCTGCAATGTTGACCCTGACCCACTCTGCTTCAGCGCCCTATCATTTGCGAGCTCTCGTGTTGTTCTGTGACGGCTCGCTGACTTTGCTGTCATGTACCGGTCCTCATTTCCATCTCTTGGCCTTTGATGCGATATCGACAGACTCGACCCGTTTCAGAGATAACCTGAGAAGATTTCGCGCCGGTGATCTCTGGCGGACCTACTTCCCACACGGACCCAAAATTTCCTACGCCCCCCTCTTTCTGTATCGGCAACGTTTTGTACATCAACCCGTGCTTCCAGATGGCCCAAAAGCCTCCACCAGGAGCTTGTAGTTGGCGACCTGGAGAGCTGTATCCTTCGATGGGGGAAAGTACTCCAGTTTGATCTATTGGATTTCCTGCGCTGCACACCCACCCTTCTTCACTGCATCGTCATCACTGTCGCTTTGATGGTTGATGTGATTACGCAAACTGATGGTTGATGAGATCACGTAAACTGATGTCTTTTCCTAGACAGTTTGCAGGTCATGTGAATGTTATCGCCAACACATTGAATGCTAAACAGATTACCTCCAACGCCTAGATGAAACCAAATTACCCTTGCCTTCTTTTTTTTTACGCCGTTAATGCAGTTGTGATAGAGACCATGCAACGTCTTCTAAACGGAGACACAAACACATTCGAGTCGATCAGATCGAAATGACTTGTTCCTGTACCTCGTCACCATCCAGCCACCGTCTGAAATAGACGCAGTTGCTGGGGCTGACAGGTCCGCCTTCCTCGCACATATCATAGACAGGGCACCGCCCACAAGGCGCCTCCATAAGGCCACTTGCACTCGGCTCAACTCCCATAAATGAGGTAACAATGCCTCCTTTGGTTGGATCATG"

# Open the file in read and write mode
handle= open(fasta_file, "r+")

# Parse the FASTA file using Biopython
fasta_sequences= SeqIO.parse(handle, "fasta")

# Create a list to store the new records
new_records= []

# Iterate over each sequence in the file
for record in fasta_sequences:
    # If the sequence ID matches, replace the sequence
    if record.id == seq_id:
        new_records.append(record.copy())
        new_records[-1].seq = new_sequence
    else
        new_records.append(record)

#Reset the file pointer to the beginning of the file
handle.seek(0)

#Write the modified FASTA records back to the file

SeqIO.write(new_records, handle, "fasta")

#Make sure to truncate the file after writing to ensure the modified file contains only the new contents.
handle.truncate()

handle.close()
