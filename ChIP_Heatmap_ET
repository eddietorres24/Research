#!/bin/bash
#SBATCH --job-name=ET_ChIP_Heatmap
#SBATCH --partition=batch
#SBATCH --mail-type=ALL
#SBATCH --mail-user=evt82290@uga.edu
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=24
#SBATCH --mem=50gb
#SBATCH --time=3:00:00
#SBATCH --output=../HeatMap.%j.out
#SBATCH --error=../HeatMap.%j.err

OUTDIR="/scratch/evt82290/Run133/BigWigs"

module load deepTools/3.5.1-intel-2020b-Python-3.8.6

#conda install -c bioconda deeptools

computeMatrix reference-point --referencePoint TSS -b 1500 -a 1500 -S $OUTDIR/133-31_ChIP_WT_H3K27me3_4hr_Rep1.bin_25.smooth_75.bw $OUTDIR/133-35_ChIP_WT_H3K27me3_8hr_Rep1_S33_L001_R1_001_val_1.fq.gz.bin_25.smooth_75.bw $OUTDIR/133-43_ChIP_WT_H3K27me3_24hr_Rep1_S40_L001_R1_001_val_1.fq.gz.bin_25.smooth_75.bw $OUTDIR/133-32_ChIP_cac-1_H3K27me3_4hr_Rep1_S30_L001_R1_001_val_1.fq.gz.bin_25.smooth_75.bw $OUTDIR/133-36_ChIP_cac-1_H3K27me3_8hr_Rep1_S34_L001_R1_001_val_1.fq.gz.bin_25.smooth_75.bw $OUTDIR/133-40_ChIP_cac-1_H3K27me3_17hr_Rep1_S37_L001_R1_001_val_1.fq.gz.bin_25.smooth_75.bw -R heatmapPRC2genes.bed --skipZeros -o matrix_PRC2.gz

plotHeatmap -m matrix_PRC2.gz -out cac1heatmap_timecourse_H3K27me2me3_Run133_hclust.png --samplesLabel WT4hr WT8hr WT24hr cac-14hr cac-18hr cac-117hr --hclust 2 --colorMap bwr
