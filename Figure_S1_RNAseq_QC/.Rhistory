K4_set7_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% K4_genes_gain_set7$gene_id)
Kac_set7_Gain_K27K36lostgenes_noCAF = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_set7$gene_id & ! CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_CAF$gene_id)
K4_set7_Gain_K27K36lostgenes_noCAF =  subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_set7$gene_id & ! CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_K4_set7_Gain <- bind_rows(
mutate(Kac_genesprom_gain_set7, .source = "Kac_genesprom_gain_set7"),
mutate(K4_genes_gain_set7, .source = "K4_genes_gain_set7")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
Kac_K4_CAF_Gain <- bind_rows(
mutate(Kac_genesprom_gain_CAF, .source = "Kac_genesprom_gain_CAF"),
mutate(K4_genes_gain_CAF, .source = "K4_genes_gain_CAF")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
#Gains only within genes that lose K27 or K36
Kac_CAF1_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_CAF$gene_id)
K4_CAF1_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_CAF1_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% Kac_genesprom_gain_CAF$gene_id)
K4_CAF1_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_set7_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_set7$gene_id)
K4_set7_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_set7$gene_id)
Kac_set7_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% Kac_genesprom_gain_set7$gene_id)
K4_set7_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% K4_genes_gain_set7$gene_id)
Kac_set7_Gain_K27K36lostgenes_noCAF = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_set7$gene_id & ! CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_CAF$gene_id)
K4_set7_Gain_K27K36lostgenes_noCAF =  subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_set7$gene_id & ! CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_K4_set7_Gain <- bind_rows(
mutate(Kac_genesprom_gain_set7, .source = "Kac_genesprom_gain_set7"),
mutate(K4_genes_gain_set7, .source = "K4_genes_gain_set7")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
Kac_K4_CAF_Gain <- bind_rows(
mutate(Kac_genesprom_gain_CAF, .source = "Kac_genesprom_gain_CAF"),
mutate(K4_genes_gain_CAF, .source = "K4_genes_gain_CAF")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, CAF_K27_K36_Lost$gene_id),
category.names = c("CAF gained", "CAF lost"),
filename = 'CAF1_Kac_K4me2_gained_K27me3_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
CAF1_K27K36lost_Kac_K4_Gain_fit = euler(c("A" = 15, "B" = 162, "A&B" = 67))
CAF1_K27K36lost_Kac_K4_Gain_eulerplot <- plot(CAF1_K27K36lost_Kac_K4_Gain_fit)
ggsave(filename = "CAF1_K27lost_Kac_K4_Gain.pdf", plot = CAF1_K27K36lost_Kac_K4_Gain_eulerplot, width = 4, height = 4, dpi = 600)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, Kac_K4_set7_Gain$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_Gain_CAF1$gene_id, Kac_Gain_set7$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
venn.diagram(
x = list(K4_Gain_CAF1$gene_id, K4_Gain_set7$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
K4_genes_gain_CAF = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac1 > 1 | H3K4me2_Results_K27genes_vWT$logFC_cac2 > 1)
K4_genes_gain_set7 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_set7 > 1)
K4_nochange = subset(H3K4me2_Results_K27genes_vWT, ! H3K4me2_Results_K27genes_vWT$gene_id %in% K4_genes_gain_CAF$gene_id & ! H3K4me2_Results_K27genes_vWT$gene_id %in% K4_genes_gain_set7$gene_id)
K4_Gain_CAF1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_CAF$gene_id)
K4_Gain_set7 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_set7$gene_id)
K4_no_change = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_nochange$gene_id)
venn.diagram(
x = list(K4_Gain_CAF1$gene_id, K4_Gain_set7$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
Kac_K4_set7_Gain <- bind_rows(
mutate(Kac_genesprom_gain_set7, .source = "Kac_genesprom_gain_set7"),
mutate(K4_genes_gain_set7, .source = "K4_genes_gain_set7")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
Kac_K4_CAF_Gain <- bind_rows(
mutate(Kac_genesprom_gain_CAF, .source = "Kac_genesprom_gain_CAF"),
mutate(K4_genes_gain_CAF, .source = "K4_genes_gain_CAF")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, Kac_K4_set7_Gain$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, Kac_K4_set7_Gain$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
CAF1_SET7_K27lost_Kac_K4_Gain_fit = euler(c("A" = 62, "B" = 42, "A&B" = 20))
CAF1_SET7_K27lost_Kac_K4_Gain_eulerplot <- plot(CAF1_SET7_K27lost_Kac_K4_Gain_fit)
ggsave(filename = "CAF1_SET7_Kac_K4_Gain.pdf", plot = CAF1_SET7_K27lost_Kac_K4_Gain_eulerplot, width = 4, height = 4, dpi = 600)
View(K36scatter)
#View what your plotting
View(out$data)
venn.diagram(
x = list(K4_Gain_CAF1$gene_id, K27lost$gene_id),
category.names = c("CAF gained", "CAF lost"),
filename = 'CAF1_Kac_K4me2_gained_K27me3_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, CAF_K27_K36_Lost$gene_id),
category.names = c("CAF gained", "CAF lost"),
filename = 'CAF1_Kac_K4me2_gained_K27me3_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(K4_Gain_CAF1$gene_id, K27lost$gene_id),
category.names = c("CAF gained", "CAF lost"),
filename = 'CAF1_K4me2_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_Gain_CAF1$gene_id, K27lost$gene_id),
category.names = c("CAF gained", "CAF lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
View(cac1DOWN)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, cacupcombinek27$gene_id),
category.names = c("CAF gained", "CAF UP"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
View(cacupcombinek27)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, cacupcombinek27$Attributes),
category.names = c("CAF gained", "CAF UP"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, cacupcombinek27$Attributes, K27lost$gene_id),
category.names = c("CAF gained", "CAF UP", "K27lost"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_Gain_CAF1$gene_id, K27lost$gene_id),
category.names = c("CAF gained", "CAF lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, cacupcombinek27$Attributes, CAF_K27_K36_Lost$gene_id),
category.names = c("CAF gained", "CAF UP", "K27lost"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, cacupcombinek27$Attributes, K27lost$gene_id),
category.names = c("CAF gained", "CAF UP", "K27lost"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
Kac_K4_gain_K27lost_CAF_Up_fit = euler(c("A" = 9, "B" = 39, "C" = 136, "A&B" = 14, "A&C" = 9, "B&C" = 97, "A&B&C" = 50))
Kac_K4_gain_K27lost_CAF_Up_eulerplot <- plot(Kac_K4_gain_K27lost_CAF_Up_fit)
ggsave(filename = "Kac_K4_gain_K27lost_CAF_Up.pdf", plot = Kac_K4_gain_K27lost_CAF_Up_eulerplot, width = 4, height = 4, dpi = 600)
venn.diagram(
x = list(Kac_Gain_CAF1$gene_id, K36lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K36 lost"),
filename = 'CAF1_Kac_gained_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_Gain_CAF1$gene_id, K27lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K27 lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain, K27lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K27 lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K36lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K36 lost"),
filename = 'CAF1_Kac_gained_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K27lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K27 lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K36lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K36 lost"),
filename = 'CAF1_Kac_gained_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
View(Kac_Results_K27promTSS_vWT)
View(Kac_Results_K27promTSS_vWT)
View(Kac_Results_K27genes_proms_vWT)
Kac_genesprom_gain_cac1 = subset(Kac_Results_K27genes_proms_vWT, Kac_Results_K27genes_proms_vWT$logFC_cac1 > 0.75)
Kac_genesprom_gain_cac2 = subset(Kac_Results_K27genes_proms_vWT, Kac_Results_K27genes_proms_vWT$logFC_cac2 > 0.75)
View(Kac_genesprom_gain_cac1)
venn.diagram(
x = list(Kac_genesprom_gain_cac1$gene_id, Kac_genesprom_gain_cac2$gene_id),
category.names = c("cac-1 gained", "cac-2 gained"),
filename = 'cac1_cac2_Kac_gained_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
K4_genes_gain_cac1 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac1 > 1)
K4_genes_gain_cac2 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac2 > 1)
View(K4_genes_gain_cac1)
####
#Gain in active mods
Kac_genesprom_gain_CAF = subset(Kac_Results_K27genes_proms_vWT, Kac_Results_K27genes_proms_vWT$logFC_cac1 > 0.75 | Kac_Results_K27genes_proms_vWT$logFC_cac2 > 0.75)
Kac_genesprom_gain_cac1 = subset(Kac_Results_K27genes_proms_vWT, Kac_Results_K27genes_proms_vWT$logFC_cac1 > 0.75)
Kac_genesprom_gain_cac2 = subset(Kac_Results_K27genes_proms_vWT, Kac_Results_K27genes_proms_vWT$logFC_cac2 > 0.75)
Kac_genesprom_gain_set7 = subset(Kac_Results_K27genes_proms_vWT, Kac_Results_K27genes_proms_vWT$logFC_set7 > 0.75 )
Kac_nochange = subset(Kac_Results_K27genes_proms_vWT, ! Kac_Results_K27genes_proms_vWT$gene_id %in% Kac_genesprom_gain_CAF$gene_id & ! Kac_Results_K27genes_proms_vWT$gene_id %in% Kac_genesprom_gain_set7$gene_id)
Kac_Gain_cac1 = subset(regions$K27genes, regions$K27genes$gene_id %in% Kac_genesprom_gaincac1$gene_id)
Kac_Gain_cac2 = subset(regions$K27genes, regions$K27genes$gene_id %in% Kac_genesprom_gaincac2$gene_id)
Kac_Gain_cac1 = subset(regions$K27genes, regions$K27genes$gene_id %in% Kac_genesprom_gain_cac1$gene_id)
Kac_Gain_cac2 = subset(regions$K27genes, regions$K27genes$gene_id %in% Kac_genesprom_gain_cac2$gene_id)
write.table(Kac_Gain_cac1, file = "Kac_Gain_cac1.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(Kac_Gain_cac2, file = "Kac_Gain_cac1.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
K4_genes_gain_CAF = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac1 > 1 | H3K4me2_Results_K27genes_vWT$logFC_cac2 > 1)
K4_genes_gain_set7 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_set7 > 1)
K4_nochange = subset(H3K4me2_Results_K27genes_vWT, ! H3K4me2_Results_K27genes_vWT$gene_id %in% K4_genes_gain_CAF$gene_id & ! H3K4me2_Results_K27genes_vWT$gene_id %in% K4_genes_gain_set7$gene_id)
K4_genes_gain_cac1 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac1 > 1)
K4_genes_gain_cac2 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac2 > 1)
K4_Gain_CAF1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_CAF$gene_id)
K4_Gain_cac1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_cac1$gene_id)
K4_Gain_cac2 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_cac2$gene_id)
K4_Gain_set7 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_set7$gene_id)
K4_no_change = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_nochange$gene_id)
write.table(K4_Gain_cac1, file = "K4_Gain_cac1.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(K4_Gain_cac2, file = "K4_Gain_cac2.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(Kac_Gain_cac1, file = "Kac_Gain_cac1.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(Kac_Gain_cac2, file = "Kac_Gain_cac2.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(K4_Gain_cac1, file = "K4_Gain_cac1.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(K4_Gain_cac2, file = "K4_Gain_cac2.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
K4_genes_gain_CAF = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac1 > 0.75 | H3K4me2_Results_K27genes_vWT$logFC_cac2 > 0.75)
K4_genes_gain_set7 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_set7 > 0.75)
K4_nochange = subset(H3K4me2_Results_K27genes_vWT, ! H3K4me2_Results_K27genes_vWT$gene_id %in% K4_genes_gain_CAF$gene_id & ! H3K4me2_Results_K27genes_vWT$gene_id %in% K4_genes_gain_set7$gene_id)
K4_genes_gain_cac1 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac1 > 0.75)
K4_genes_gain_cac2 = subset(H3K4me2_Results_K27genes_vWT, H3K4me2_Results_K27genes_vWT$logFC_cac2 > 0.75)
K4_Gain_CAF1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_CAF$gene_id)
K4_Gain_cac1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_cac1$gene_id)
K4_Gain_cac2 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_cac2$gene_id)
K4_Gain_set7 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_set7$gene_id)
K4_no_change = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_nochange$gene_id)
write.table(K4_Gain_cac1, file = "K4_Gain_cac1.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
write.table(K4_Gain_cac2, file = "K4_Gain_cac2.bed", sep = "\t", quote = FALSE, row.names = FALSE, col.names = FALSE)
K4_Gain_CAF1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_CAF$gene_id)
K4_Gain_cac1 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_cac1$gene_id)
K4_Gain_cac2 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_cac2$gene_id)
K4_Gain_set7 = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_genes_gain_set7$gene_id)
K4_no_change = subset(regions$K27genes, regions$K27genes$gene_id %in% K4_nochange$gene_id)
#Gains only within genes that lose K27 or K36
Kac_CAF1_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_CAF$gene_id)
K4_CAF1_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_CAF1_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% Kac_genesprom_gain_CAF$gene_id)
K4_CAF1_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_set7_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% Kac_genesprom_gain_set7$gene_id)
K4_set7_Gain_K27K36lostgenes = subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_set7$gene_id)
K4_set7_Gain_K27lostgenes = subset(K27lost, K27lost$gene_id %in% K4_genes_gain_set7$gene_id)
K4_set7_Gain_K27K36lostgenes_noCAF =  subset(CAF_K27_K36_Lost, CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_set7$gene_id & ! CAF_K27_K36_Lost$gene_id %in% K4_genes_gain_CAF$gene_id)
Kac_K4_set7_Gain <- bind_rows(
mutate(Kac_genesprom_gain_set7, .source = "Kac_genesprom_gain_set7"),
mutate(K4_genes_gain_set7, .source = "K4_genes_gain_set7")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
Kac_K4_CAF_Gain <- bind_rows(
mutate(Kac_genesprom_gain_CAF, .source = "Kac_genesprom_gain_CAF"),
mutate(K4_genes_gain_CAF, .source = "K4_genes_gain_CAF")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, cacupcombinek27$Attributes, K27lost$gene_id),
category.names = c("CAF gained", "CAF UP", "K27lost"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, Kac_K4_set7_Gain$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_K27_lost_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF1_Gain$gene_id, Kac_K4_set7_Gain$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K27lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K27 lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K36lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K36 lost"),
filename = 'CAF1_Kac_gained_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_genesprom_gain_cac1$gene_id, Kac_genesprom_gain_cac2$gene_id),
category.names = c("cac-1 gained", "cac-2 gained"),
filename = 'cac1_cac2_Kac_gained_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
#####################################################
#FIGURE 4
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, cacupcombinek27$Attributes, K27lost$gene_id),
category.names = c("CAF gained", "CAF UP", "K27lost"),
filename = 'CAF1_Kac_K4_gained_Upreg_genes.png',
col=c("#8da0cb","#756bb1","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, Kac_K4_set7_Gain$gene_id),
category.names = c("CAF gained", "SET7 gained"),
filename = 'CAF1_set7_Kac_K4me2_gained_genes.png',
col=c("#8da0cb","#756bb1"),
fill = c(alpha("#8da0cb",0.25), alpha("#756bb1",0.25)),
output=TRUE)
Kac_K4_gain_K27lost_CAF_Up_fit = euler(c("A" = 21, "B" = 35, "C" = 129, "A&B" = 18, "A&C" = 16, "B&C" = 86, "A&B&C" = 61))
Kac_K4_gain_K27lost_CAF_Up_eulerplot <- plot(Kac_K4_gain_K27lost_CAF_Up_fit)
ggsave(filename = "Kac_K4_gain_K27lost_CAF_Up.pdf", plot = Kac_K4_gain_K27lost_CAF_Up_eulerplot, width = 4, height = 4, dpi = 600)
CAF1_SET7_K27lost_Kac_K4_Gain_fit = euler(c("A" = 82, "B" = 44, "A&B" = 34))
CAF1_SET7_K27lost_Kac_K4_Gain_eulerplot <- plot(CAF1_SET7_K27lost_Kac_K4_Gain_fit)
ggsave(filename = "CAF1_SET7_Kac_K4_Gain.pdf", plot = CAF1_SET7_K27lost_Kac_K4_Gain_eulerplot, width = 4, height = 4, dpi = 600)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K27lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K27 lost"),
filename = 'CAF1_Kac_gained_K27me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_K4_CAF_Gain$gene_id, K36lost$gene_id),
category.names = c("CAF Kac/K4 gained", "CAF K36 lost"),
filename = 'CAF1_Kac_gained_K36me3_lost_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(Kac_genesprom_gain_cac1$gene_id, Kac_genesprom_gain_cac2$gene_id),
category.names = c("cac-1 gained", "cac-2 gained"),
filename = 'cac1_cac2_Kac_gained_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
Kac_K4_cac1_Gain <- bind_rows(
mutate(Kac_genesprom_gain_cac1, .source = "Kac_genesprom_gain_cac1"),
mutate(K4_genes_gain_cac1, .source = "K4_genes_gain_cac1")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
Kac_K4_cac2_Gain <- bind_rows(
mutate(Kac_genesprom_gain_cac2, .source = "Kac_genesprom_gain_cac2"),
mutate(K4_genes_gain_cac2, .source = "K4_genes_gain_cac2")
) %>%
# if you want cac1UP to win on collisions, keep this order
distinct(gene_id, .keep_all = TRUE) %>%
select(-.source)
venn.diagram(
x = list(Kac_K4_cac1_Gain$gene_id, Kac_K4_cac2_Gain$gene_id),
category.names = c("cac-1 gained", "cac-2 gained"),
filename = 'cac1_cac2_Kac_gained_genes.png',
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
CAF1_Kac_K4_Gain_K36_lost_fit = euler(c("A" = 82, "B" = 44, "A&B" = 34))
CAF1_Kac_K4_Gain_K36_lost_eulerplot <- plot(CAF1_Kac_K4_Gain_K36_lost_fit)
CAF1_Kac_K4_Gain_K36_lost_fit = euler(c("A" = 82, "B" = 44, "A&B" = 34))
CAF1_Kac_K4_Gain_K36_lost_eulerplot <- plot(CAF1_Kac_K4_Gain_K36_lost_fit)
ggsave(filename = "CAF1_Kac_K4_Gain_K36_lost.pdf", plot = CAF1_Kac_K4_Gain_K36_lost_eulerplot, width = 4, height = 4, dpi = 600)
CAF1_Kac_K4_Gain_K36_lost_fit = euler(c("A" = 79, "B" = 55, "A&B" = 37))
CAF1_Kac_K4_Gain_K36_lost_eulerplot <- plot(CAF1_Kac_K4_Gain_K36_lost_fit)
ggsave(filename = "CAF1_Kac_K4_Gain_K36_lost.pdf", plot = CAF1_Kac_K4_Gain_K36_lost_eulerplot, width = 4, height = 4, dpi = 600)
cac1_cac2_Kac_K4_gained_fit = euler(c("A" = 80, "B" = 2, "A&B" = 34))
cac1_cac2_Kac_K4_gained_eulerplot <- plot(cac1_cac2_Kac_K4_gained_fit)
ggsave(filename = "cac1_cac2_Kac_K4_gained.pdf", plot = cac1_cac2_Kac_K4_gained_eulerplot, width = 4, height = 4, dpi = 600)
View(allDataTPM)
#only coding genes (i.e. no tRNA or rRNA genes)
K27lost_code = subset(K27lost, K27lost$gene_id %in% rownames(allDataTPM))
#only coding genes (i.e. no tRNA or rRNA genes)
K27lost_nocode = subset(K27lost, ! K27lost$gene_id %in% rownames(allDataTPM))
View(K27lost_nocode)
##################################
#FIGURE 2
#Patterns of genes that lose H3K27me3 in CAF-1 mutants
venn.diagram(
x = list(K27lost$gene_id, cacupcombinek27$Attributes),
category.names = c("K27_lost", "K27lost_CAF_UP"),
filename = "K27lost_CAF-1_UP.png",
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
venn.diagram(
x = list(K27lost_set7UP$gene_id, K27lost_cac1cac2UP$gene_id),
category.names = c("K27lost_set7_UP", "K27lost_CAF_UP"),
filename = "K27lost_set7UP_CAF1UP.png",
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
K27lost_cac1cac2UP = subset(K27lost_code, K27lost_code$gene_id %in% cacupcombinek27$Attributes)
K27lost_set7UP = subset(K27lost_code, K27lost_code$gene_id %in% set7_RNA_K27$Attributes)
venn.diagram(
x = list(K27lost_set7UP$gene_id, K27lost_cac1cac2UP$gene_id),
category.names = c("K27lost_set7_UP", "K27lost_CAF_UP"),
filename = "K27lost_set7UP_CAF1UP.png",
col=c("#8da0cb","#fc8d62"),
fill = c(alpha("#8da0cb",0.25), alpha("#fc8d62",0.25)),
output=TRUE)
tbldir <- file.path(outdir, "tables");  dir.create(tbldir, FALSE, TRUE)
## =============== user-config (edit as needed) =================
counts_file      <- "readcounts_All_CAF1paper.merged.txt"   # genes x samples (raw counts)
coldata_file     <- "coldata.csv"                            # must include 'sample_id' and 'condition'
gene_map_file    <- "gene_annotation.csv"                    # optional: gene_id,gene_symbol
k27_bed_file     <- "H3K27me3_methylated_genes_FINAL.bed"    # optional: IDs in col 10
outdir           <- "RNAseq_QC_out"
reference_level  <- "WT"                                     # reference level in 'condition'
min_count_filter <- 10                                       # keep genes with rowSums >= this
ma_ylim          <- c(-6, 6)                                 # y-limits for MA plots
# ---- load packages (no installs) ----
need <- c("DESeq2","data.table","dplyr","tibble","ggplot2","pheatmap","readr","stringr","tidyr")
source("C:/Users/eddie/Research/GitHub/Research/Figure_S1_RNAseq_QC/Figure_S1_RNA-seq_QC_script.R", echo=TRUE)
getwd()
setwd(C:/Users/eddie/Research/GitHub/Research/Figure_S1_RNAseq_QC)
setwd(C:Users/eddie/Research/GitHub/Research/Figure_S1_RNAseq_QC)
setwd(/Users/eddie/Research/GitHub/Research/Figure_S1_RNAseq_QC)
/
setwd(C:/Users/eddie/Research/GitHub/Research/Figure_S1_RNAseq_QC)
setwd("C:\\Users\\eddie\\Research\\GitHub\\Research\\Figure_S1_RNAseq_QC")
source("Figure_S1_RNA-seq_QC_script.R")
View(counts_dt)
glimpse(counts_dt)
head(counts_dt)
source("Figure_S1_RNA-seq_QC_script.R")
source("Figure_S1_RNA-seq_QC_script.R")
source("Figure_S1_RNA-seq_QC_script.R")
source("Figure_S1_RNA-seq_QC_script.R")
source("Figure_S1_RNA-seq_QC_script.R")
